name: sh-idxnode
description: Datahaven Indexer node
fullnameOverride: sh-idxnode

image:
  repository: datahavenxyz/datahaven
  tag: main
  pullPolicy: Always

imagePullSecrets:
  - name: datahaven-dockerhub

node:
  command: datahaven-node
  customChainspecUrl: http://dh-bootnode:8080/chainspec.json
  forceDownloadChainspec: true
  role: full
  replicas: 1
  chainData:
    pruning: 1000
    storageClass: "gp2"
  chainKeystore:
    storageClass: "gp2"
  keys:
    # This is Alice seed. To generate new seed run: docker run --rm datahavenxyz/datahaven:latest key generate
    - seed: "bottom drive obey lake curtain smoke basket hold race lonely fit walk"
      type: bcsv
      scheme: sr25519
      # ${HOSTNAME##*-} will be evaluated as the pod index, pod-0: //Gustavo, pod-1: //Hermano
      extraDerivation: '$([ "${HOSTNAME##*-}" = "0" ] && echo "//Gustavo" || echo "//Hermano")'
  persistGeneratedNodeKey: true
  flags:
    - "--allow-private-ipv4"
    - "--discover-local"
    - "--network-backend libp2p"
    - "--indexer"
    - "--indexer-mode full"
    - "--indexer-database-url postgresql://datahaven:datahaven@dh-postgres:5432/datahaven"

ingress:
  enabled: false
  perReplica: false
  wildcardDomain: datahaven.local
  # If enabled, this would generate:
  # - sh-idxnode-0.datahaven.local
